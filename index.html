<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sai Vista Ganesh Festival Celebration 2025 - Events Nomination</title>

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- FontAwesome CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <style>
    /* Background image with light overlay */
    body {
      font-family: 'Poppins', sans-serif;
      min-height: 100vh;
      margin: 0;
      background: 
        linear-gradient(rgba(255 255 255 / 0.85), rgba(255 255 255 / 0.85)),
        url('https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/9a9e5246-2775-4394-85c3-89fa79691620.png') no-repeat center center fixed;
      background-size: cover;
      color: #5a4b05;
    }

    /* Container card */
    .container-card {
      max-width: 700px;
      margin: 3rem auto 4rem auto;
      background: #fffdef;
      padding: 2.5rem 3rem;
      border-radius: 1.5rem;
      box-shadow: 0 10px 30px rgba(246, 224, 94, 0.25);
      border: 3px solid #f6e05e;
      user-select: none;
    }

    /* Headings */
    header h1 {
      color: #d6b221;
      font-weight: 800;
      text-shadow: 1px 1px 3px #a98008aa;
    }
    header p {
      color: #a18306;
      font-weight: 600;
      text-shadow: 1px 1px 2px #c6a509aa;
    }

    /* Labels */
    label {
      color: #63530a;
      font-weight: 600;
    }

    /* Inputs & selects */
    input[type="text"],
    input[type="tel"],
    select {
      background: #fffff6;
      border: 2px solid #f6e05e;
      border-radius: 0.75rem;
      padding: 0.75rem 1rem;
      font-weight: 500;
      font-size: 1rem;
      color: #4a4000;
      box-shadow: inset 0 2px 6px #fefbc7;
      transition: all 0.3s ease;
      width: 100%;
      margin-top: 0.25rem;
    }
    input[type="text"]:focus,
    input[type="tel"]:focus,
    select:focus {
      outline: none;
      border-color: #d2aa12;
      box-shadow: 0 0 10px #f6e05eaa;
      background: #fffff9;
    }

    /* Button */
    button {
      background: #f6e05e;
      background-image: linear-gradient(45deg, #f6e05e, #d49c0a);
      color: #4a3900;
      font-weight: 700;
      font-size: 1.15rem;
      border: none;
      border-radius: 1rem;
      padding: 1rem 0;
      cursor: pointer;
      box-shadow: 0 6px 20px #d49c0aaa;
      transition:
        background-position 0.3s ease,
        box-shadow 0.3s ease,
        transform 0.25s ease;
      width: 100%;
      user-select: none;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 0.75rem;
    }
    button:hover:not(:disabled) {
      background-position: right center;
      box-shadow: 0 12px 30px #d49c0acc;
      transform: translateY(-3px);
      color: #372b00;
    }
    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      box-shadow: none;
      transform: none;
    }

    /* Fieldset and legend */
    fieldset {
      border: 2.5px solid #f6e05e;
      border-radius: 1rem;
      padding: 1rem 1.5rem 1.5rem 1.5rem;
      background-color: #fff9caaa;
      box-shadow: inset 0 0 10px #d2a60bb5;
      margin-bottom: 1.5rem;
    }
    legend {
      font-weight: 700;
      font-size: 1.2rem;
      color: #a38300;
      user-select: none;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    /* Events checkbox container */
    #eventsCheckboxes {
      max-height: 18rem;
      overflow-y: auto;
      margin-top: 0.75rem;
      padding-right: 0.5rem;
    }
    /* Scrollbar for events list */
    #eventsCheckboxes::-webkit-scrollbar {
      width: 8px;
    }
    #eventsCheckboxes::-webkit-scrollbar-track {
      background: transparent;
    }
    #eventsCheckboxes::-webkit-scrollbar-thumb {
      background-color: #d4ac1b99;
      border-radius: 10px;
    }
    #eventsCheckboxes {
      scrollbar-width: thin;
      scrollbar-color: #d4ac1b99 transparent;
    }

    /* Checkbox styles */
    input[type="checkbox"] {
      appearance: none;
      -webkit-appearance: none;
      background-color: #fffdef;
      border: 2.5px solid #f6e05e;
      border-radius: 0.375rem;
      width: 1.3rem;
      height: 1.3rem;
      cursor: pointer;
      position: relative;
      margin-right: 0.75rem;
      box-shadow: 0 2px 6px #f1df4d7a;
      transition: background-color 0.3s ease, border-color 0.3s ease;
    }
    input[type="checkbox"]:checked {
      background-color: #f6e05e;
      border-color: #c29c0a;
      box-shadow: 0 0 5px #d49c0aae;
    }
    input[type="checkbox"]:checked::after {
      content: '';
      position: absolute;
      left: 0.38rem;
      top: 0.1rem;
      width: 0.3rem;
      height: 0.7rem;
      border: solid #4a4000;
      border-width: 0 0.25rem 0.25rem 0;
      transform: rotate(45deg);
      pointer-events: none;
    }
    input[type="checkbox"]:focus-visible {
      outline: 3px solid #f6e05edd;
      outline-offset: 2px;
    }

    /* Labels for checkboxes */
    label[for^="event"], label[for="ack"] {
      cursor: pointer;
      user-select: none;
      font-weight: 600;
      color: #6e5e04;
      display: flex;
      align-items: center;
    }

    /* Form spacing adjustments */
    .flex.items-start.space-x-3 input[type="checkbox"] {
      margin-top: 0.35rem;
    }

    /* Header icon */
    header i.fas.fa-hands-praying {
      text-shadow: 1px 1px 4px #cba800cc;
    }

    /* Footer */
    footer {
      color: #8b7e01;
      text-align: center;
      padding: 1.25rem 0;
      font-weight: 600;
      user-select: none;
      font-size: 1rem;
      letter-spacing: 0.02em;
    }

    /* Responsive */
    @media (max-width: 480px) {
      .container-card {
        margin: 1.5rem 1rem 3rem 1rem;
        padding: 2rem 2rem;
      }
      button {
        font-size: 1.1rem;
        padding: 0.9rem 0;
      }
    }
  </style>
</head>

<body>
  <header class="text-center pt-10 mb-6 select-none">
    <i class="fas fa-hands-praying fa-4x text-yellow-400 mb-3"></i>
    <h1 class="text-3xl font-extrabold text-yellow-500 drop-shadow">Sai Vista Ganesh Festival 2025</h1>
    <p class="mt-1 text-lg text-yellow-700 font-semibold">Daily Events Nomination Form: Aug 28 - Sept 5</p>
  </header>

  <main class="container-card">
    <form id="eventsForm" novalidate class="space-y-6">
      <div>
        <label for="name">Full Name <span class="text-red-600">*</span></label>
        <input type="text" id="name" name="name" required placeholder="Your full name" autocomplete="name" />
        <p id="nameError" class="hidden text-red-600 text-sm mt-1">Please enter your name.</p>
      </div>

      <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
        <div>
          <label for="flatNo">Flat Number <span class="text-red-600">*</span></label>
          <select id="flatNo" name="flatNo" required>
            <option value="" disabled selected>Select Flat Number</option>
          </select>
          <p id="flatNoError" class="hidden text-red-600 text-sm mt-1">Please select flat number.</p>
        </div>
        <div>
          <label for="wing">Wing <span class="text-red-600">*</span></label>
          <select id="wing" name="wing" required>
            <option value="" disabled selected>Select Wing</option>
            <option value="A">A</option><option value="B">B</option><option value="C">C</option>
            <option value="D">D</option><option value="E">E</option><option value="F">F</option>
          </select>
          <p id="wingError" class="hidden text-red-600 text-sm mt-1">Please select wing.</p>
        </div>
      </div>

      <div>
        <label for="whatsapp">WhatsApp Number <span class="text-red-600">*</span></label>
        <input
          type="tel"
          id="whatsapp"
          name="whatsapp"
          required
          pattern="[0-9]{10}"
          maxlength="10"
          placeholder="Enter 10-digit WhatsApp number"
          autocomplete="tel"
        />
        <p id="whatsappError" class="hidden text-red-600 text-sm mt-1">Please enter a valid 10-digit WhatsApp number.</p>
        <p class="text-yellow-700 text-xs mt-1">Enter number without country code</p>
      </div>

      <fieldset aria-describedby="eventError">
        <legend><i class="fas fa-calendar-day mr-2"></i>Select Events to Participate <span class="text-red-600">*</span></legend>
        <p id="eventError" class="hidden text-red-600 text-sm mt-1 mb-2">Please select at least one event.</p>
        <div id="eventsCheckboxes" class="space-y-2">
          <!-- Checkboxes will be injected here -->
        </div>
      </fieldset>

      <div class="flex items-start space-x-3">
        <input type="checkbox" id="ack" name="ack" required aria-describedby="ackError" />
        <label for="ack" class="text-sm select-none">I acknowledge that my details may be used for event coordination and festival management. <span class="text-red-600">*</span></label>
      </div>
      <p id="ackError" class="text-red-600 text-sm mt-1 hidden">Please acknowledge before submitting.</p>

      <button type="submit" id="submitButton" aria-label="Submit Nomination">
        <i class="fas fa-paper-plane mr-2"></i> Submit Nomination
      </button>
    </form>
  </main>

  <footer>
    &copy; 2025 Sai Vista Ganesh Festival &mdash; Aug 28 to Sept 5
  </footer>

  <script>
    // Populate flat numbers 1-13 floors, flats 01-04
    const flatSelect = document.getElementById("flatNo");
    for(let floor=1; floor<=13; floor++){
      for(let flat=1; flat<=4; flat++){
        const val = `${floor}${flat < 10 ? "0"+flat : flat}`;
        const opt = document.createElement("option");
        opt.value = val;
        opt.textContent = val;
        flatSelect.appendChild(opt);
      }
    }

    // Events array
    const events = [
      { id: "event1", day: 1, date: "28 Aug", name: "Modak Making" },
      { id: "event2", day: 2, date: "29 Aug", name: "Drawing Competition" },
      { id: "event3", day: 3, date: "30 Aug", name: "Antakshari" },
      { id: "event4", day: 4, date: "31 Aug", name: "Fancy Dress" },
      { id: "event5", day: 5, date: "1 Sep", name: "Rangoli" },
      { id: "event6", day: 6, date: "2 Sep", name: "Talent Show" },
      { id: "event7", day: 7, date: "3 Sep", name: "Sports" },
      { id: "event8", day: 8, date: "4 Sep", name: "Quiz" },
      { id: "event9", day: 9, date: "5 Sep", name: "Prize Function" },
    ];

    const eventsContainer = document.getElementById("eventsCheckboxes");
    events.forEach(({ id, day, date, name }) => {
      const div = document.createElement("div");
      div.className = "flex items-center";

      const checkbox = document.createElement("input");
      checkbox.type = "checkbox";
      checkbox.id = id;
      checkbox.name = "events";
      checkbox.value = `Day ${day} - ${date} - ${name}`;

      const label = document.createElement("label");
      label.htmlFor = id;
      label.textContent = `Day ${day} - ${date} - ${name}`;

      div.appendChild(checkbox);
      div.appendChild(label);
      eventsContainer.appendChild(div);
    });

    // WhatsApp input: restrict to digits max 10 chars
    const whatsappInput = document.getElementById("whatsapp");
    whatsappInput.addEventListener("input", () => {
      whatsappInput.value = whatsappInput.value.replace(/\D/g, "").slice(0,10);
    });

    // Form handling and validation
    const form = document.getElementById("eventsForm");
    const submitBtn = document.getElementById("submitButton");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      // Hide all errors first
      document.getElementById("nameError").classList.add("hidden");
      document.getElementById("flatNoError").classList.add("hidden");
      document.getElementById("wingError").classList.add("hidden");
      document.getElementById("whatsappError").classList.add("hidden");
      document.getElementById("eventError").classList.add("hidden");
      document.getElementById("ackError").classList.add("hidden");

      let valid = true;

      if (!form.name.value.trim()) {
        document.getElementById("nameError").classList.remove("hidden");
        valid = false;
      }
      if (!form.flatNo.value) {
        document.getElementById("flatNoError").classList.remove("hidden");
        valid = false;
      }
      if (!form.wing.value) {
        document.getElementById("wingError").classList.remove("hidden");
        valid = false;
      }
      if (!/^\d{10}$/.test(form.whatsapp.value)) {
        document.getElementById("whatsappError").classList.remove("hidden");
        valid = false;
      }
      if (document.querySelectorAll('input[name="events"]:checked').length === 0) {
        document.getElementById("eventError").classList.remove("hidden");
        valid = false;
      }
      if (!form.ack.checked) {
        document.getElementById("ackError").classList.remove("hidden");
        valid = false;
      }

      if (!valid) return;

      submitBtn.disabled = true;
      submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Submitting...';

      // Prepare data to send
      const formData = {
        name: form.name.value.trim(),
        flatNo: form.flatNo.value,
        wing: form.wing.value,
        whatsapp: form.whatsapp.value,
        events: Array.from(document.querySelectorAll('input[name="events"]:checked')).map(cb => cb.value).join("; "),
        acknowledge: form.ack.checked ? "Yes" : "No",
        timestamp: new Date().toISOString(),
      };

      // Replace with your Google Apps Script deployed URL
      const GOOGLE_SCRIPT_URL = "YOUR_GOOGLE_APPS_SCRIPT_WEBAPP_URL";

      try {
        const response = await fetch(GOOGLE_SCRIPT_URL, {
          method: "POST",
          headers: { "Content-Type": "application/x-www-form-urlencoded" },
          body: new URLSearchParams(formData)
        });

        if (!response.ok) throw new Error(`Error: ${response.status}`);

        // On success, hide form and show a thank-you message
        form.style.display = "none";

        const thankYou = document.createElement("section");
        thankYou.className = "container-card text-center font-semibold text-lg text-amber-900";
        thankYou.innerHTML = `
          <i class="fas fa-check-circle text-4xl mb-4 text-amber-700"></i>
          <p>Thank you for your nomination!<br>We will connect with you soon on WhatsApp.<br>
          For any changes, please message admin at <strong>8149525915</strong>.</p>
        `;

        document.querySelector("main").appendChild(thankYou);
        thankYou.scrollIntoView({ behavior: "smooth" });

      } catch (error) {
        alert("Submission failed. Please try again or contact admin at 8149525915.");
        console.error(error);
      } finally {
        submitBtn.disabled = false;
        submitBtn.innerHTML = '<i class="fas fa-paper-plane mr-2"></i> Submit Nomination';
      }
    });
  </script>
</body>
</html>
